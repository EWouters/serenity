From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Tim Schumacher <timschumi@gmx.de>
Date: Mon, 2 Oct 2023 01:17:46 +0200
Subject: [PATCH] Adapt to the Serenity thread name interface

---
 libavutil/thread.h | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/libavutil/thread.h b/libavutil/thread.h
index 2ded498c8991b24630ce818121859e6f5ac206a4..be989396490e3ba4e2f1f974657eb8cd4b2ae2cf 100644
--- a/libavutil/thread.h
+++ b/libavutil/thread.h
@@ -26,6 +26,8 @@
 
 #if HAVE_PRCTL
 #include <sys/prctl.h>
+#include <unistd.h>
+#include <string.h>
 #endif
 
 #include "error.h"
@@ -214,7 +216,7 @@ static inline int ff_thread_once(char *control, void (*routine)(void))
 static inline int ff_thread_setname(const char *name)
 {
 #if HAVE_PRCTL
-    return AVERROR(prctl(PR_SET_NAME, name));
+    return AVERROR(prctl(PR_SET_THREAD_NAME, gettid(), name, strlen(name)));
 #endif
 
     return AVERROR(ENOSYS);
